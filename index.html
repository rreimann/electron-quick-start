<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Hello World!</title>
  </head>
  <body>
    <h1>Hello World!</h1>
    A new timestamp should render every 5 seconds - updated via SSE from 'https://sse.now.sh/'<br/>
    Clicking this <a href="https://github.com/electron/electron/releases/download/v1.6.10/electron-api.json">download link</a> should not break the EventSource.

    <p/>
    <span>current EventSource.readyState: </span><span id="state"></span>
    <p>timer events:</p>
    <p id="events"></p>
  </body>

  <script>
    var eventsDiv = document.querySelector('#events');
    var stateDiv = document.querySelector('#state');

    function log(message) {
      eventsDiv.innerHTML = message + '<br />' + eventsDiv.innerHTML;
    }

    var source = new EventSource('https://sse.now.sh/');

    source.onmessage = function(e) {
      log(e.data);
    };
    source.onerror = function(e) {
      log(`got onerror for EventSource - current readyState is: ${source.readyState}`);
    };

    function logState() {
      stateDiv.innerHTML = source.readyState;
    }
    logState();
    setInterval(logState, 1000 * 2);
  </script>
</html>
